#
#                                            clip-xml/Makefile.in
#
# This is a part of CLIP-XML library
#
# Copyright (C) 2006 by E/AS Software Foundation
# Author: Andrey Cherepanov <skull@eas.lrn.ru>
#
# Copyright (C) 2006 by ITK
# Author: Alena <alena@itk.ru>
#

Local_Depend = include/*.h include/*.ch


#CLIP = $(CLIPROOT)/bin/clip

.SUFFIXES: .prg .o .po

LIBS= -lexpat $(C_LIBS)
#CFLAGS  = -I. $(C_FLAGS)
# $(XCFLAGS)

#XLIB=libclip-xml.a
#XSLIB=libclip-xml$(DLLSUFF)
#XSLIBREAL=libclip-xml$(DLLREALSUFF)

#XTARGETS=$(XLIB) $(XSLIB)
CLIPFLAGS += -n
PROG= clip-xml
SRC = expat.c
OBJ = expat.o
XLIBOBJS = $(OBJ)
OBJS    = xmltag.o xmltree.o xpath.o

HDRS	= include/clip-expat.ch
HASHSRCS = $(SRC) $(HDRS)

.PHONY: all clean uninstall distclean

all : Makefile hash lib $(STARGET)

cfg :
	cp --remove-destination -fpu$(V) include/clip-expat.ch $(Clip_I_Dir)/
	cp --remove-destination -fpu$(V) include/clip-expat.h $(Clip_I_Dir)/

hash: include/_hashxml.h

include/_hashxml.h: $(HASHSRCS)
	$(Trace)
	clip_hashextract$(EXESUFF) $(HASHSRCS) | sort -u > include/_hashxml.h
	cmp include/_hashxml.h include/hashxml.h 2>/dev/null || cp -f$(V) include/_hashxml.h include/hashxml.h


lib :
	[ -f $(Dir_Lib) ]

#$(XLIB): $(XLIBOBJS)  $(OBJS)
#	rm -f $(XLIB)
#	$(CLIP_MAKELIB) $(XLIB) $(XLIBOBJS)  $(OBJS)
#	ranlib $(XLIB)

#$(XSLIB): $(XLIB)  $(OBJS)
#	$(CLIP_MAKESLIB) $(XSLIB) $(XLIB) $(LIBS)  $(OBJS)
#	$(CLIP_CP) $(XLIB) $(XSLIB) $(DESTDIR)/lib/


install : all install-lib install-example
#	$(CLIP_CP) $(XLIB) $(XSLIB) $(DESTDIR)/lib/
#	chmod 0644  $(DESTDIR)/lib/$(XLIB)
#	chmod 0755  $(DESTDIR)/lib/$(XSLIB)
#	mkdir -p$(V) $(DESTDIR)$/doc/example/clip-xml
#	cp -fu$(V)R example/* $(DESTDIR)/doc/example/clip-xml/

cleanc:
	rm -rf$(V) *.b $(TARGET).*

commit:
	_cvs commit

update:
	_cvs update -dP

ucommit:
	_cvs update -dP && _cvs commit

shell:
	sh

include $(Makefile_o_in)

include $(Makefile_end_in)

