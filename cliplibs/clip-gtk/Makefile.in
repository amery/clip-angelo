#
#                                            clip-gtk/Makefile.in
#
# main part
#
#
include Makefile.inc
#export CC
#DBGFLAGS	= -g #-DMEMDBG
#WARNFLAGS	= -Wimplicit -Wall

.SUFFIXES: .prg .c .po
.PHONY:	test screen hash

Local_Depend = include/*.ch include/*.h

HDRS	= include/clip-gtk.ch include/clip-gtk.h

GDK_SRC = gdk.c gdkfont.c gdkinput.c gdkcolor.c gdkgc.c gdkdraw.c \
	  gdkwindow.c gdkregion.c $(PIXBUFSRC)

GTK_SRC = accelgroup.c adjustment.c alignment.c bmpxpm.c box.c button.c buttonbox.c calendar.c \
	  checkbutton.c checkmenuitem.c clist.c colorsel.c combo.c common.c \
	  container.c ctree.c curve.c dialog.c drawingarea.c editable.c entry.c \
	  filesel.c fixed.c fontsel.c frame.c general.c gtkdraw.c handlebox.c item.c \
	  itemfactory.c \
	  label.c layout.c list.c listitem.c menu.c menubar.c menuitem.c \
	  menushell.c misc.c notebook.c object.c optionmenu.c packer.c paned.c \
	  pixmap.c progress.c progressbar.c radiobutton.c radiomenuitem.c \
	  range.c rulers.c scale.c scrollbar.c scrolledwindow.c separator.c \
	  spinbutton.c statusbar.c table.c text.c tipsquery.c togglebutton.c \
	  toolbar.c tooltips.c tree.c treeitem.c viewport.c widget.c window.c \
	  gtkermsg.prg

GTK_EXTEXT_SRC = #gtkextext.c extext.c

GDK_OBJ = gdk.o gdkfont.o gdkinput.o gdkcolor.o gdkgc.o gdkdraw.o \
	  gdkwindow.o gdkregion.o $(PIXBUFOBJ)

GTK_OBJ = accelgroup.o adjustment.o alignment.o bmpxpm.o box.o button.o buttonbox.o calendar.o \
	  checkbutton.o checkmenuitem.o clist.o colorsel.o combo.o common.o \
	  container.o ctree.o curve.o dialog.o drawingarea.o editable.o entry.o \
	  filesel.o fixed.o fontsel.o frame.o general.o gtkdraw.o handlebox.o item.o \
	  itemfactory.o \
	  label.o layout.o list.o listitem.o menu.o menubar.o menuitem.o \
	  menushell.o misc.o notebook.o object.o optionmenu.o packer.o paned.o \
	  pixmap.o progress.o progressbar.o radiobutton.o radiomenuitem.o \
	  range.o rulers.o scale.o scrollbar.o scrolledwindow.o separator.o \
	  spinbutton.o statusbar.o table.o text.o tipsquery.o togglebutton.o \
	  toolbar.o tooltips.o tree.o treeitem.o viewport.o widget.o window.o \
	  gtkermsg.o

GTK_EXTEXT_OBJ = #gtkextext.o extext.o

SRCS = $(GDK_SRC) $(GTK_SRC) $(GTK_EXTEXT_SRC)

OBJS = $(sort $(GDK_OBJ) $(GTK_OBJ) $(GTK_EXTEXT_OBJ))

OBJDIR	= .
EXTOBJS =

HASHSRCS = $(SRCS) $(HDRS)

#XLIB	= libclip-gtk.a
#XSLIB	= libclip-gtk$(DLLSUFF)
#XSLIBREAL = libclip-gtk$(DLLREALSUFF)
#XLIBOBJS= $(OBJS)
PROG = clip-gtk
SYS = $OSNAME
SYSTEM_NAME = $(OSNAME)

DEFS	=
# -DVERSION=\"0.1\"
# -DSYSTEM=\"$(SYSTEM_NAME)\"

#CC = $(COMPILER)
C_FLAGS  += $(DEFS) $(MEMDBGFLAGS) $(XCFLAGS)
# $(INCLUDEDIRS)
#  $(WARNFLAGS) $(DBGFLAGS) $(OPTFLAGS) -I$(INCLUDE)

export CC CFLAGS
export MEMDBG MEMDBGFLAGS

all: Makefile include/clip-gtkcfg.h hash $(STARGET)

cfg :
	cp --remove-destination -fpu$(V) clip-gtk.cliprc $(INSTDIR)/cliprc/
	cp --remove-destination -fpu$(V) include/clip-gtk.ch include/clip-gtk.h $(Clip_I_Dir)/

d: set_dbg

set_dbg: CDBGFLAGS=-g
set_dbg: all

include/clip-gtkcfg.h :
	$(Trace)
	./configure

hash: include/_hashcode.h

include/_hashcode.h: $(HASHSRCS)
	$(Trace)
	clip_hashextract$(EXESUFF) $(HASHSRCS) | sort -u > include/_hashcode.h
	cmp include/_hashcode.h include/hashcode.h 2>/dev/null || cpinclude/ _hashcode.h include/hashcode.h
	cp -puf$(V)  include/hashcode.h include/_hashcode.h

#$(XLIB): $(XLIBOBJS)
#	rm -f $(XLIB)
#	$(CLIP_MAKELIB) $(XLIB) $(XLIBOBJS)
#	ranlib $(XLIB)

#$(XSLIB): $(XLIB)
#	$(CLIP_MAKESLIB) $(XSLIB) $(XLIB) $(LIBS)

cleanc:
	rm -rf$(V) *.b include/clip-gtkcfg.h gtkermsg.c $(TARGET).*

distclean: clean
	rm -rf$(V) include/clip-gtkcfg.h include/hashcode.h include/_hashcode.h
	-cd test &&  $(MAKE) clean
	-cd example && $(MAKE) clean

install:all install-lib install-example
#	$(CLIP_CP) $(XLIB) $(XSLIB) $(INSTDIR)/lib/
#	chmod 0644 $(INSTDIR)/lib/$(XLIB)
#	chmod 0755 $(INSTDIR)/lib/$(XSLIB)
#	mkdir -p$(V) $(INSTDIR)/doc/example/clip-gtk
#	cp -fu$(V) example/clipgtktest.prg example/Makefile example/clip.xpm example/basket.bmp $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/tbrow.prg example/tbrow.xpm $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/accel.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/test.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/note.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/test_gtk.prg example/x.xpm $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/test_list.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/test_image.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/simple.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/winpic.prg $(INSTDIR)/doc/example/clip-gtk/
#	cp -fu$(V) example/window.prg $(INSTDIR)/doc/example/clip-gtk/

include $(Makefile_o_in)

depend:
	$(MAKE) hash
	makedepend -Y  -- $(C_FLAGS) -- $(SRCS) 2>/dev/null

commit:
	_cvs commit

update:
	_cvs update -dP

ucommit:
	_cvs update -dP && _cvs commit

shell:
	sh

include $(Makefile_end_in)

