#
#                                            clip-gtkextra/Makefile.in
#
# main part
#
#

Local_Depend = include/*.ch include/*.h
#export CC
#DBGFLAGS	= -g #-DMEMDBG
#WARNFLAGS	= -Wimplicit -Wall

.SUFFIXES: .prg .c .po
.PHONY:	tests screen hash

SRCS  = sheet.c fontcombo.c bordercombo.c colorcombo.c togglecombo.c \
	combobox.c itementry.c

OBJS  = $(sort bordercombo.o colorcombo.o combobox.o fontcombo.o itementry.o sheet.o togglecombo.o )

HDRS	= include/clip-gtkextra.ch include/clip-gtkextra.h ../clip-gtk/include/clip-gtk.ch

OBJDIR	= .
EXTOBJS =

HASHSRCS = $(SRCS) $(HDRS)
PROG = clip-gtkextra
#XLIB	= libclip-gtkextra.a
#XSLIB	= libclip-gtkextra$(DLLSUFF)
#XSLIBREAL = libclip-gtkextra$(DLLREALSUFF)
#XLIBOBJS= $(OBJS)

SYS = $OSNAME
SYSTEM_NAME = $(OSNAME)

DEFS	=
# -DVERSION=\"0.1\"
# -DSYSTEM=\"$(SYSTEM_NAME)\"

CC = $(COMPILER)
C_FLAGS  += $(DEFS) $(MEMDBGFLAGS) -I../include/clip-gtk $(XCFLAGS)
#  $(WARNFLAGS) $(DBGFLAGS) $(OPTFLAGS) -I$(INCLUDE)

export CC CFLAGS
export MEMDBG MEMDBGFLAGS

all: Makefile include/clip-gtkextracfg.h hash $(STARGET)

cfg :
	cp --remove-destination -fpu$(V) include/clip-gtkextra.ch $(Clip_I_Dir)/

d: set_dbg

set_dbg: CDBGFLAGS=-g
set_dbg: all

include/clip-gtkextracfg.h : $(CONFIGURE_SH)
	$(Trace)
	$(CONFIGURE_SH)

hash: include/_hashcode.h

include/_hashcode.h: $(HASHSRCS)
	$(Trace)
	clip_hashextract$(EXESUFF) $(HASHSRCS) | sort -u > include/_hashcode.h
	cmp include/_hashcode.h include/hashcode.h 2>/dev/null || cp --remove-destination -fpu$(V) include/_hashcode.h include/hashcode.h
	cp -fp$(V)  include/hashcode.h include/_hashcode.h

#$(XLIB): $(XLIBOBJS)
#	rm -f $(XLIB)
#	$(CLIP_MAKELIB) $(XLIB) $(XLIBOBJS)
#	ranlib $(XLIB)

#$(XSLIB): $(XLIB)
#	$(CLIP_MAKESLIB) $(XSLIB) $(XLIB) $(LIBS)

test: install
	cd example && $(MAKE)

cleanc:
	rm -rf$(V) *.b $(TARGET).* Makefile.inc

distcleanc :
	rm -rf$(V) *.g


install: all install-lib install-example
#	$(CLIP_CP) $(XLIB) $(XSLIB) $(DESTDIR)/lib
#	chmod 0644  $(DESTDIR)/lib/$(XLIB)
#	chmod 0755  $(DESTDIR)/lib/$(XSLIB)
#	mkdir -p$(V) $(DESTDIR)/doc/example/clip-gtkextra
#	cp -fu$(V) example/*.prg example/Makefile example/*.ch $(DESTDIR)/doc/example/clip-gtkextra

include $(Makefile_o_in)

#.c.o:
#	@echo $(CC) $(CDBGFLAGS) $(CFLAGS) -c $<
#	@$(CC) $(CDBGFLAGS) $(CFLAGS) $(XCFLAGS) -c $<

depend:
	$(MAKE) hash
	makedepend -Y  -- $(CFLAGS) -- $(SRCS) 2>/dev/null

commit:
	_cvs commit

update:
	_cvs update -dP

ucommit:
	_cvs update -dP && _cvs commit

shell:
	sh

include $(Makefile_end_in)

