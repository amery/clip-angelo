#
#                                            clip/tools/Makefile.in
#
# main parts
#
#
Local_Depend = ../include.h/*.h
Depend_on =

BINS	=	clipar$(EXESUFF) clip_conv$(EXESUFF) clip_dbg$(EXESUFF) clip_trans$(EXESUFF) \
			clip_hashextract$(EXESUFF) cliphash$(EXESUFF) \
			genlist$(EXESUFF)	gen_tbl$(EXESUFF) $(PO_BINS)

SCRIPTS = clip_cp$(SCRIPTSUFF) clip_bug$(SCRIPTSUFF) joinlib$(SCRIPTSUFF) lowname$(SCRIPTSUFF) 	\
						clip_makelib$(SCRIPTSUFF) clip_makeslib$(SCRIPTSUFF) inst_end$(SCRIPTSUFF) tconv$(SCRIPTSUFF) 	\
						clip_msgfmt$(SCRIPTSUFF) clip_msgmerge$(SCRIPTSUFF) add_meta_tag$(SCRIPTSUFF)

export CC CFLAGS $(PO_BINS)
export CLIP CLIPFLAGS
export MEMDBG MEMDBGFLAGS Clip_I_Dir
export CLIPROOT BINDIR

################################################################################################################

all: Makefile links $(DIRS_TO_SCAN) $(BINS) $(SCRIPTS)

links:

cfg :
	$(E_if)[ -d charsets ] \
		|| ln -sf$(V) ../libclipscreen/install/charsets .

FORCE :

../libclipmain/coll.o: ../libclipmain/coll.c Makefile
	$(E_cd)cd ../libclipmain 																			\
		&& ( [ -f Makefile ] || ( [ -x $(CONFIGURE_SH) ] && $(CONFIGURE_SH) ) )			\
		&& $(MAKE) coll.o

../libclipmain/_win32.o: ../libclipmain/_win32.c Makefile
	$(E_cd)cd ../libclipmain 																			\
		&& ( [ -f Makefile ] || ( [ -x $(CONFIGURE_SH) ] && $(CONFIGURE_SH) ) )			\
		&& $(MAKE) _win32.o

../libclipscreen/charset.o: ../libclipscreen/charset.c Makefile
	$(E_cd)cd ../libclipscreen  																		\
		&& ( [ -f Makefile ] || ( [ -x $(CONFIGURE_SH) ] && $(CONFIGURE_SH) ) )		\
		&& $(MAKE) charset.o

include $(Makefile_o_in)

clip_hash.o: ../libclipmain/cliphash.c Makefile
	$(E_if)if [ -f $(subst .o,.g,$@) ] ; then 						\
		$(Trace_c_d) ; 														\
		$(CC) $(CFLAGS) -g -DSTANDALONE -o clip_hash.o -c $< ; 	\
	else 																			\
		$(Trace_c) ; 															\
		$(CC) $(CFLAGS) -DSTANDALONE -o clip_hash.o -c $< ; 		\
	fi

lex.hash.o: lex.hash.c Makefile
	$(E_if)if [ -f $(subst .o,.g,$@) ] ; then 	\
		$(Trace_c_d) ; 									\
		$(CC) $(CFLAGS) -g -c $< ; 					\
	else 														\
		$(Trace_c) ; 										\
		$(CC) $(CFLAGS) -c $< ; 						\
	fi

lex.hash.c: hasher.lex ../include.h/cliphash.h
	$(Trace_flex)
	$(E_xx)flex -Phash hasher.lex

clicutil.o: clicutil.c clic.tab.h Makefile
	$(E_if)if [ -f $(subst .o,.g,$@) ] ; then 	\
		$(Trace_c_d) ; 									\
		$(CC) $(CFLAGS) -g -c $< ; 					\
	else 														\
		$(Trace_c) ; 										\
		$(CC) $(CFLAGS) -c $< ; 						\
	fi

install : all
	$(E_xx)chmod 755 $(BINS) $(SCRIPTS)
	$(E_cp)cp --remove-destination -fpu$(V) $(BINS) $(SCRIPTS) $(Clip_B_Dir)/
#|| true
	$(E_cd)cd $(BINDIR) \
		&& ln -sf$(V) $(Clip_B_Dir)/*$(EXESUFF) $(Clip_B_Dir)/*$(SCRIPTSUFF) $(BINDIR)/

clipar$(EXESUFF) :	clipar.o ../libclipmain/coll.o  Makefile #getopt.o
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 														\
		$(Trace_c_d) ; 																						\
		$(CC) $(CFLAGS) $(STATICLINK) -g -o $@ clipar.o ../libclipmain/coll.o $(MLIB) ; 	\
	else 																											\
		$(Trace_c) ; 																							\
		$(CC) $(CFLAGS) $(STATICLINK) -o $@ clipar.o ../libclipmain/coll.o $(MLIB) ; 		\
	fi

clip_conv$(EXESUFF) :  clip_conv.o ../libclipscreen/charset.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 												\
		$(Trace_c_d) ; 																				\
		$(CC) $(CFLAGS) -g -o $@ clip_conv.o ../libclipscreen/charset.o $(MLIB) ; 	\
	else 																									\
		$(Trace_c) ; 																					\
		$(CC) $(CFLAGS) -o $@ clip_conv.o ../libclipscreen/charset.o $(MLIB) ; 		\
	fi

clip_dbg$(EXESUFF) :  clip_dbg.o ../libclipmain/coll.o ../libclipmain/_win32.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 																			\
		$(Trace_c_d) ; 																											\
		$(CC) $(CFLAGS) -g -o $@ clip_dbg.o ../libclipmain/coll.o ../libclipmain/_win32.o $(ADDLIBS) ; 	\
	else 																																\
		$(Trace_c) ; 																												\
		$(CC) $(CFLAGS) -o $@ clip_dbg.o ../libclipmain/coll.o ../libclipmain/_win32.o $(ADDLIBS) ; 		\
	fi

clip_trans$(EXESUFF) :  clip_trans.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 	\
		$(Trace_c_d) ; 									\
		$(CC) $(CFLAGS) -g -o $@ clip_trans.o ; 	\
	else 														\
		$(Trace_c) ; 										\
		$(CC) $(CFLAGS) -o $@ clip_trans.o ; 		\
	fi

clip_msgmerge$(SCRIPTSUFF) : clip_msgmerge.ini Makefile
	$(E_e)$(Trace)
	$(E_xx)./clip_msgmerge.in.sh

clip_makeslib$(SCRIPTSUFF) : clip_makeslib.ini Makefile
	$(E_e)$(Trace)
	$(E_xx)./clip_makeslib.in.sh

clip_cp$(SCRIPTSUFF) : clip_cp.ini Makefile
	$(E_e)$(Trace)
	$(E_xx)./clip_cp.in.sh

clip_makelib$(SCRIPTSUFF) : clip_makelib.ini Makefile
	$(E_e)$(Trace)
	$(E_xx)./clip_makelib.in.sh

clip_msgfmt$(SCRIPTSUFF) : clip_msgfmt.ini Makefile
	$(E_e)$(Trace)
	./clip_msgfmt.in.sh

cliphash$(EXESUFF) : calchash.o clip_hash.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 				\
		$(Trace_c_d) ; 												\
		$(CC) $(CFLAGS) -g -o $@ calchash.o clip_hash.o ; 	\
	else 																	\
		$(Trace_c) ; 													\
		$(CC) $(CFLAGS) -o $@ calchash.o clip_hash.o ; 		\
	fi

genlist$(EXESUFF) : genlist.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 	\
		$(Trace_c_d) ; 									\
		$(CC) $(CFLAGS) -g -o $@ genlist.c ; 		\
	else 														\
		$(Trace_c) ; 										\
		$(CC) $(CFLAGS) -o $@ genlist.c ; 			\
	fi

gen_tbl$(EXESUFF) : gen_tbl.o ../libclipscreen/charset.o ../libclipmain/coll.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 																		\
		$(Trace_c_d) ; 																										\
		$(CC) $(CFLAGS) -o $@  gen_tbl.o ../libclipscreen/charset.o ../libclipmain/coll.o $(MLIB) ; 	\
	else 																															\
		$(Trace_c) ; 																											\
		$(CC) $(CFLAGS) -o $@  gen_tbl.o ../libclipscreen/charset.o ../libclipmain/coll.o $(MLIB) ; 	\
	fi

clip_hashextract$(EXESUFF): lex.hash.o clip_hash.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 		\
		$(Trace_c_d) ; 										\
		$(CC) -O -g -o $@ lex.hash.o clip_hash.o ; 	\
	else 															\
		$(Trace_c) ; 											\
		$(CC) -O -o $@ lex.hash.o clip_hash.o ; 		\
	fi

po_extr$(EXESUFF): po_util.o ../libclipmain/coll.o po_extr.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 													\
		$(Trace_c_d) ; 																					\
		$(CC) $(CFLAGS) -g -o $@ po_extr.o po_util.o ../libclipmain/coll.o $(MLIB) ; 	\
	else 																										\
		$(Trace_c) ; 																						\
		$(CC) $(CFLAGS) -o $@ po_extr.o po_util.o ../libclipmain/coll.o $(MLIB) ; 		\
	fi

po_subst$(EXESUFF): po_util.o ../libclipmain/coll.o po_subst.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 																		\
		$(Trace_c_d) ; 																										\
		$(CC) $(CFLAGS) -g -o $@ po_subst.o po_util.o ../libclipmain/coll.o $(ICONV_LIB) $(MLIB) ; 	\
	else 																															\
		$(Trace_c) ; 																											\
		$(CC) $(CFLAGS) -o $@ po_subst.o po_util.o ../libclipmain/coll.o $(ICONV_LIB) $(MLIB) ; 		\
	fi

po_compat$(EXESUFF): po_util.o po_compat.o Makefile
	$(E_if)if [ -f $(subst .o,.g,$<) ] ; then 				\
		$(Trace_c_d) ; 												\
		$(CC) $(CFLAGS) -g -o $@ po_compat.o po_util.o ; 	\
	else 																	\
		$(Trace_c) ; 													\
		$(CC) $(CFLAGS) -o $@ po_compat.o po_util.o ; 		\
	fi

clip_bug$(SCRIPTSUFF) : Makefile
	$(E_e)$(Trace)
	$(E_cp)cp --remove-destination -f$(V) clip_bug $@

joinlib$(SCRIPTSUFF) : inst_end Makefile
	$(E_e)$(Trace)
	$(E_cp)cp --remove-destination -f$(V) joinlib  $@

inst_end$(SCRIPTSUFF) : inst_end  Makefile
	$(E_e)$(Trace)
	$(E_cp)cp --remove-destination -f$(V) inst_end  $@

add_meta_tag$(SCRIPTSUFF) : add_meta_tag Makefile
	$(E_e)$(Trace)
	$(E_cp)cp --remove-destination -f$(V) add_meta_tag $@

lowname$(SCRIPTSUFF) : lowname Makefile
	$(E_e)$(Trace)
	$(E_cp)cp --remove-destination -f$(V) lowname $@

tconv$(SCRIPTSUFF) : tconv Makefile
	$(E_e)$(Trace)
	$(E_cp)cp --remove-destination -f$(V) tconv $@

cleanc :
	$(E_rm)rm -Rf$(V) bin
	$(E_rm)rm -f$(V) charsets
# || true
	$(E_rm)rm -f$(V) 	$(BINS) $(SCRIPTS) *.b 					\
							test dtest locale.pot license.h 		\
							Makefile.inc Makefile.tmp 				\
							Makefile.incl
#  || true
	$(E_rm)rm -f$(V) clipcfg.sh clipcfg.h license.txt
# || true

distcleanc: clean
	$(E_rm)rm -f$(V) *.g configure.flags
	$(E_rm)rm -f$(V) cliproot
# || true

depend:
	makedepend -Y  -- $(CFLAGS) -- $(SRCS) 2>/dev/null

include $(Makefile_end_in)

# DO NOT DELETE

