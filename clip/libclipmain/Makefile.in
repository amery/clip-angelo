#
#                                            clip/libclipmain/Makefile.in
#
Local_Depend = ../include/*.ch ../include.h/*.h

OBJS = $(sort 	cliphash.o rt.tab.o 														\
	   			_file1.o _string.o _date.o 											\
	  				clipbase.o _math.o diskutils.o _mem.o 								\
	  				_system.o rational.o integer.o gettext.o _dbg.o 				\
	  				_tcp.o _tcpserv.o _regex.o ncp.o _clipboard.o _depsort.o 	\
	  				_ctools_s.o _file.o  _io.o _thread.o _util.o  					\
	  				clipdbg.o cliprt.o cliptbl.o clipvm.o 								\
	  				hash.o set.o coll.o list.o plural.tab.o _win32.o )

ADDOBJS = ../libclipscreen/charset.o

PROG = clipmain

################################################################################################################

install all: Makefile $(ATARGET)

cfg :
	$(E_if)[ -d charsets ] \
		|| ln -sf$(V) ../libclipscreen/install/charsets .

cleanc:
	$(E_rm)rm -f$(V) 	*.b *.tmp test_ref.c test.c test.log 	\
							*.dbf *.ntx *.cdx *.dbt *.fpt 			\
							test $(ATARGET)

distcleanc :
	$(E_rm)rm -rf$(V) *.g

include $(Makefile_o_in)

../libclipscreen/charset.o: ../libclipscreen/charset.c Makefile
	$(E_cd)cd ../libclipscreen  															\
		&& ( [ -f Makefile ] || ( [ -x $(CONFIGURE_SH) ] && $(CONFIGURE_SH) ) )	\
		&& $(MAKE) charset.o $(MAKEFLAGS) $(ADDMAKECMDGOALS)

plural.tab.c: plural.y
	$(E_e)$(Trace_yacc)
	$(YACC) -bplural -pplural plural.y

plural.tab.o: plural.tab.c Makefile
	$(E_if)if [ -f $(subst .o,.g,$@) ] ; then 	\
		$(Trace_c_d) ; 									\
		$(CC) $(CFLAGS) -g -c $< ; 					\
	else 														\
		$(Trace_c) ; 										\
		$(CC) $(CFLAGS) -c $< ; 						\
	fi

yacc : plural.tab.c

include $(Makefile_end_in)
